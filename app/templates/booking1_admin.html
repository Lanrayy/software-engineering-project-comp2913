{% extends "base.html" %}
{% block left_content %}
<!-- For the table of prices -->
<div class="container d-flex flex-column align-items-left" style = "margin-left: 20%; margin-top: 10%">

  <div class="mt-5" style = "margin-bottom: 4%">
    <h1 class = "fw-normal text-nowrap">Our Prices!</h1>
  </div>

  {% for hire_period in hire_periods %}
  <div >
    <h5 class = "fw-normal ">Hire Period: {{ hire_period.duration }}</h5>
    <p style="font-family: Raleway; font-size: 18px">Â£{{ "{:.2f}".format(hire_period.price) }}</p>
  </div>
  {% endfor %}


</div>
{% endblock %}

{% block content %}
<!-- blank margin space -->
<br>

<div class="row d-flex justify-content-center">
  <div class="col-md-auto">
    <!-- row for header -->
    <div class="row p-3">
      <div class="row">
        <h1 class="text-nowrap">Make A Booking</h1>
      </div>

      <!-- row for form contents -->
      <div class="row p-3">
        <form  method="post" name="bookingform">
          {{ form.csrf_token }}
          {{ form.hidden_tag() }}

          <div class="row pt-3 flex-nowrap">
            <div class="col pe-4">
              <p class="text-nowrap">
                Choose a Collection Point <br>
                {{ form.location_id (style="width:100%; height:50px; font-size:18px", class="form-control form-control-lg form-select")}}
              </p>
              <p class="text-nowrap">
                Choose a Scooter <br>
                {{ form.scooter_id (style="width:100%; height:50px; font-size:18px", class="form-control form-control-lg form-select")}}
              </p>
              <p class="text-nowrap">
                Select a Hire Period <br>
                {{ form.hire_period (style="width:100%; height:50px; font-size:18px", class="form-control form-control-lg form-select")}}
              </p>
              <p class="text-nowrap">
                  Select start date and time (dd-mm-yyyy hours:minutes)<br>
                  {{ form.start_date (style="width:100%; height:50px; font-size:18px", class="form-control form-control-lg")}}
              </p>
              <p class="text-nowrap">
                Enter email address <br>
                {{ form.email (style="width:100%; height:50px", class="form-control form-control-lg")}}
              </p>
              <div class="col">
                <button type="button submit"  class="btn btn-success action-button2" name="payment_button">Go to Payment</button>
              </div>
            </div>

          </div>

          <div class="row pt-3">


          </div>

          <div class="row text-center pt-3">

          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<script>
  let location_select = document.getElementById('location_id');
  let scooter_select = document.getElementById('scooter_id');

  location_select.onchange = function() {
    location_id = location_select.value;

    fetch('booking1/' + location_id).then(function(response) {
      response.json().then(function(data) {
        let optionHTML = '';
        let count = 0;
        for(let scooter of data.scooters) {
          optionHTML += '<option value = "' + scooter.id + '">' + "Scooter ID: " + scooter.id + '</option>';
          count++;
        }

        if(count == 0) {
          optionHTML = '<option value = "0">No Scooters Available</option>';
        }

        scooter_select.innerHTML = optionHTML;
      });
    });
  }
</script>
{% endblock %}

{% block right_content %}
<div class="row pt-5 ps-3">
  <img src="{{ url_for('static', filename='images/booking.png') }}" alt="Make a Booking" style= "position:relative; right:10%; width:200px; height: 200px; min-width:200px"  class="p-2">
</div>
{% endblock %}
